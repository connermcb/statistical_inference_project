---
title: "Statistical Inference Project"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part 1: Simulation Exercise
## Overview

The exponential distribution has a mean of 1/lambda where lambda is the rate of growth parameter for the exponential function. Taking a random sample of 1000 observations from the exponential distribution, the sample parameters (mean and variation) will be compared to the theoritical mean and variation.


## Simulations

To begin with, the random sample is taken using 0.2 as the rate for the exponential function. A sampling of 40 observations is repeated 1000 times and subsequently organized into a 1000x40 matrix for ease of processing. Row-wise calculation of the mean for each 40 observation sampling is completed and then passed to the analysis in the next section of this report.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# simulation variables
n <- 40  #number of random observations taken per sample
B <- 1000  #number of samples

# create simulation matrix
M <- matrix(rexp(n*B, 0.2), B, n)

# get mean of each sample
M_means <- apply(M, 1, mean)
```

## Distribution of Random Sample Distributions
## Sample Mean versus Theoretical Mean


The vector of 1000 means from the previous section are plotted as a histogram. 
```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# histogram of means of sampled distributions
hist(M_means, breaks=30, 
     main="Frequency of Sample Means", xlab = "Sample Means")

# add vertical lines for sample and theoretical means
abline(v=mean(M_means), col="blue", lwd=2) # mean of sampled means
abline(v=1/.2, col="red", lwd=2) # theoretical mean
```

The distribution is nearly Gaussian in accord with the Central Limit Theorem. Also, the theoretical mean (mu=`r 1/.2`) is nearly identical to the sample mean (mean=`r mean(M_means)`) which is as expected since although the sample distribution has its own distribution it is centered at mu the population mean.

## Sample Variance versus Theoretical Variance

The sample variance should be centered around what it is estimating, sigma, the population or theoretical variation. First the standard deviation for each 40 observation sample is calculated and collectively assigned to a variable.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# calculate sd of samples
M_variations <- apply(M, 1, sd)
```

Just as with the sample mean, the frequencies of the sample variations as measured by standard deviation is plotted. The mean of the sample standard deviations (blue) and the population standard deviation (red) are also plotted as vertical lines.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# histogram of means of sampled distributions
hist(M_variations, breaks=45, 
     main="Frequency of Sample Standard Deviations", 
     xlab = "Sample Standard Deviations")

# add vertical lines for sample and theoretical means
abline(v=mean(M_variations), col="blue", lwd=2) # mean of sampled means
abline(v=1/.2, col="red", lwd=2) # theoretical mean
```

In the case of sample variation, the distribution is near Gaussian despite a slight right skew. The mean of the sample standard deviations (s=`r mean(M_variations)`) is very close as an estimate to the population or theoretical standard deviation (sigma=`r 1/.2`). This makes sense since we know that the distribution of the sample variance (in this case standard deviation) is centered on the parameter that is is estimating (i.e. the population variation).

## Distribution



* * *

# Part 2: Basic Inferential Data Analysis

## Overview

In this section of the report, hypothesis testing is conducted on a tooth growth data for under different supplement regiments.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# fetch libraries
library(datasets)
data("ToothGrowth")

```

## Basic Data Summary

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# get dimensions
dim(ToothGrowth)

# table of tooth growth by supplement and dose
table(ToothGrowth$supp, ToothGrowth$dose)
```

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# overall comparison of supplements w/o control for dosage 
oj_all <- ToothGrowth[ToothGrowth$supp=="OJ",]
vd_all <- ToothGrowth[ToothGrowth$supp=="VC",]

plot(oj_all$len, pch=oj_all$dose, col="red", 
     main="Tooth Growth by Supplement and Dose", 
     ylab="Tooth Growth",
     ylim=c(0,40))
points(vd_all$len, pch=vd_all$dose, col="blue")

```

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# boxplots of distributions of tooth growth by supplement and dose

boxplot(len~dose, data=oj_all, col="red",
        boxwex=0.4, at=1:3-.25,
        main="Guinea Pigs' Tooth Growth", 
        xlab = "Vitamin C Dose (mg)", ylab = "Tooth Length",
        xlim=c(0.5, 3.5), ylim=c(0,40))
boxplot(len~dose, data=vd_all, boxwex=0.4, at=1:3+.25, col="blue", add=TRUE)
legend(0.5, 40, c("Orange Juice", "Ascorbic Acid"), fill=c("red", "blue"))


```

## Inferential Testing

To start, a test is performed to look for a significant difference in mean tooth length by supplement without controlling for dose.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
# t-test for difference in means
overall_test <- t.test(vd_all$len, oj_all$len, paired = FALSE)
overall_test$p.value
overall_test

```

The p-value for the difference in overall means (p=`r overall_test$p.value`) is very close to the commonly accepted alpha value for significance 0.05. At the same time, the corresponding confidence interval of 95% includes zero, but only barely. This is at once reason to not reject H_0 and cause for further investigation since the borderline statistics and the exploratory plots suggest that controlling for dosage might yield significant differences.  

So next we'll perform t-tests on the difference in means of the two supplements this time controlling for dose.

```{r echo=FALSE, message=FALSE, warning=FALSE, error=FALSE}
oj_0.5 <- ToothGrowth[ToothGrowth$supp=="OJ" & ToothGrowth$dose==0.5, 1]
oj_1 <- ToothGrowth[ToothGrowth$supp=="OJ" & ToothGrowth$dose==1, 1]
oj_2 <- ToothGrowth[ToothGrowth$supp=="OJ" & ToothGrowth$dose==2, 1]

# t-test for difference in means by dose
dose_0.5 <- t.test(oj_all[oj_all$dose==0.5,]$len, vd_all[vd_all$dose==0.5,]$len,
                   paired = FALSE)

dose_1.0 <- t.test(oj_all[oj_all$dose==1,]$len, vd_all[vd_all$dose==1,]$len,
                   paired = FALSE)

dose_2.0 <- t.test(oj_all[oj_all$dose==2,]$len, vd_all[vd_all$dose==2,]$len,
                   paired = FALSE)

dose_0.5$estimate[[2]]
dose_2.0
```




## Citations

Boxplot ideas from Roger Bivand R documentation